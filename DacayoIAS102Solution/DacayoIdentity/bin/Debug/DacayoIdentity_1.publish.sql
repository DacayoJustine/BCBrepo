/*
Deployment script for DacayoIdentity

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "DacayoIdentity"
:setvar DefaultFilePrefix "DacayoIdentity"
:setvar DefaultDataPath "C:\Users\Osting\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\MSSQLLocalDB\"
:setvar DefaultLogPath "C:\Users\Osting\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\MSSQLLocalDB\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Creating Table [dbo].[HealthForm]...';


GO
CREATE TABLE [dbo].[HealthForm] (
    [Id]                    INT            NOT NULL,
    [FirstName]             NVARCHAR (250) NULL,
    [MiddleName]            NVARCHAR (250) NULL,
    [LastName]              NVARCHAR (250) NULL,
    [Suffix]                NVARCHAR (250) NULL,
    [BirthDate]             NVARCHAR (250) NULL,
    [Age]                   NVARCHAR (250) NULL,
    [Gender]                NVARCHAR (250) NULL,
    [FathersName]           NVARCHAR (250) NULL,
    [MothersName]           NVARCHAR (250) NULL,
    [HeadOfFamily]          NVARCHAR (250) NULL,
    [TotalNumberOfFamily]   NVARCHAR (250) NULL,
    [EducationalAttainment] NVARCHAR (250) NULL,
    [Purok]                 NVARCHAR (250) NULL,
    [PWD]                   NVARCHAR (250) NULL,
    [Prenatal]              NVARCHAR (250) NULL,
    [TypesOfIllness]        NVARCHAR (250) NULL,
    [Immunation]            NVARCHAR (250) NULL,
    [Weight]                NVARCHAR (250) NULL,
    [Height]                NVARCHAR (250) NULL,
    [Temperature]           NVARCHAR (250) NULL,
    [BloodPressure]         NVARCHAR (250) NULL,
    [Medicine]              NVARCHAR (250) NULL,
    CONSTRAINT [PK_HealthForm_Id] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Procedure [dbo].[CreateHealthProfile]...';


GO
CREATE PROCEDURE [dbo].[CreateHealthProfile]
	@Id NVARCHAR(250), 
    @FirstName NVARCHAR(250), 
    @MiddleName NVARCHAR(250), 
    @LastName NVARCHAR(250), 
    @Suffix NVARCHAR(250), 
    @BirthDate NVARCHAR(250), 
    @Age NVARCHAR(250), 
    @Gender NVARCHAR(250), 
    @FathersName NVARCHAR(250), 
    @MothersName NVARCHAR(250), 
    @HeadOfFamily NVARCHAR(250), 
    @TotalNumberOfFamily NVARCHAR(250), 
    @EducationalAttainment NVARCHAR(250), 
    @Purok NVARCHAR(250), 
    @PWD NVARCHAR(250), 
    @Prenatal NVARCHAR(250),
    @TypesOfIllness NVARCHAR(250),
    @Immunation NVARCHAR(250),
    @Height NVARCHAR(250),
    @Weight NVARCHAR(250),
    @Temperature NVARCHAR(250),
    @BloodPressure NVARCHAR(250),
    @Medicine NVARCHAR(250)
	
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @HealthProfileId NVARCHAR(250);

	SELECT @HealthProfileId = [a].[Id]
	FROM [dbo].[HealthForm] AS a
	WHERE [a].[FirstName] = @FirstName
	    AND [a].[MiddleName] = @MiddleName
		AND [a].[LastName] = @LastName
		AND [a].[Suffix] = @Suffix
		AND [a].[BirthDate] = @BirthDate
		AND [a].[Age] = @Age
		AND [a].[Gender] = @Gender
		AND [a].[FathersName] = @FathersName
		AND [a].[MothersName] = @MothersName
		AND [a].[HeadOfFamily] = @HeadOfFamily
		AND [a].[TotalNumberOfFamily] = @TotalNumberOfFamily
		AND [a].[EducationalAttainment] = @EducationalAttainment
		AND [a].[Purok] = @Purok
		AND [a].[PWD] = @PWD
		AND [a].[Prenatal] = @Prenatal
		AND [a].[TypesOfIllness] = @TypesOfIllness
		AND [a].[Immunation] = @Immunation
		AND [a].[Height] = @Height
		AND [a].[Weight] = @Weight
		AND [a].[Temperature] = @Temperature
		AND [a].[BloodPressure] = @BloodPressure
		AND [a].[Medicine] = @Medicine;
		
	
	IF LEN(COALESCE(@HealthProfileId, N''))=0
	BEGIN
		INSERT INTO [dbo].[HealthForm]([Id] ,[FirstName],[MiddleName], [LastName], [Suffix], 
		[BirthDate], [Age], [Gender], [FathersName], 
		[MothersName], [HeadOfFamily], [TotalNumberOfFamily], [EducationalAttainment], [Purok], [PWD],[Prenatal],[TypesOfIllness], [Immunation], [Height], [Weight], [Temperature], [BloodPressure], [Medicine])

		VALUES(@Id ,@FirstName ,@MiddleName, @LastName, @Suffix, @BirthDate, @Age, @Gender, @FathersName, @MothersName, @HeadOfFamily, @TotalNumberOfFamily, @EducationalAttainment, @Purok, @PWD, @Prenatal, @TypesOfIllness, @Immunation, @Height, @Weight, @Temperature, @BloodPressure, @Medicine);
	END
END
GO
PRINT N'Update complete.';


GO
